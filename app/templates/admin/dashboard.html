{% extends "base.html" %}

{% block page_class %}bg-admin{% endblock %}

{% block content %}

<div class="admin-container">
    
    <div class="admin-header-row">
        <div class="header-pill title-pill">
            <span>Administrador</span>
        </div>

        <div class="header-pill search-pill">
            <form action="{{ url_for('admin.admin_users') }}" method="GET" style="width: 100%; display: flex;">
                <input 
                    type="text" 
                    name="search" 
                    placeholder="Buscar User (Pulsa Enter)" 
                    class="search-input"
                    value="{{ request.args.get('search', '') }}"
                >
                <button type="submit" style="display: none;"></button>
            </form>
        </div>

        <a href="{{ url_for('admin.pending_users') }}" class="header-pill link-pill">
            <span>Nuevas cuentas</span>
        </a>
    </div>

    <div class="user-list-wrapper">
        {% if users %}
            {% for user in users %}
            <div class="user-card">
                <div class="avatar-container">
                    {% if user.foto %}
                        <img src="{{ url_for('static', filename=user.foto | replace('static/', '') | replace('\\', '/')) }}" 
                            alt="Avatar de {{ user.nombreUsuario }}" 
                            style="width: 100%; height: 100%; object-fit: contain;">
                    {% else %}
                        <img src="{{ url_for('static', filename='img/usuario/user1.png') }}" 
                            alt="Avatar por defecto" 
                            style="width: 100%; height: 100%; object-fit: contain;">
                    {% endif %}
                </div>

                <div class="user-info">
                    <span class="nickname">{{ user.nombreUsuario }}</span>
                    <span style="font-size: 0.8em; color: gray;">{{ user.rol }}</span>    
                </div>

                <div class="action-buttons">
                    <a href="{{ url_for('admin.edit_user_form', nickname=user.nombreUsuario) }}" class="btn-img btn-edit" title="Editar">
                        <img src="{{ url_for('static', filename='img/iconos/simbolo_editar.png') }}" alt="Editar">
                    </a>
                    
                    <a href="{{ url_for('admin.delete_user', nickname=user.nombreUsuario) }}" 
                       class="btn-img btn-delete" 
                       title="Borrar usuario" 
                       onclick="return confirm('¿Seguro que quieres borrar a {{ user.nombreUsuario }}? Esta acción es irreversible.');">
                        <img src="{{ url_for('static', filename='img/iconos/simbolo_Eliminar_Rosa.png') }}" alt="Eliminar">
                    </a>
                </div>
            </div>
            {% endfor %}
            <div id="no-results-message" style="display: none; text-align: center; width: 100%; padding: 20px; color: #666; font-size: 1.2em;">
                <p>Usuario no encontrado o no existe</p>
            </div>
        {% else %}
            <div class="empty-message">No hay usuarios activos.</div>
        {% endif %}
    </div>
</div>
<a href="{{ url_for('pokedex.mostrarPokedex') }}" class="btn-back-fixed">
    <img src="{{ url_for('static', filename='img/iconos/simbolo_Volver.png') }}" alt="Volver">
</a>
{% endblock %}